# üéµ Free Pirate Instrumentals Guide

Your Pirate Karaoke app **already supports background music**! The code in `app/tasks.py` automatically:
1. Detects the BPM of your vocals
2. Finds a matching instrumental from the beats library
3. Mixes them together

You just need to add some free pirate-themed beat files!

---

## üìÅ Directory Structure

Beats go here:
```
EmoryHack/
  beats/
    pirate-shanty/          ‚Üê Put your WAV files here
      pirate_beat_90bpm.wav
      sea_shanty_95bpm.wav
      nautical_loop_100bpm.wav
    catalog.json            ‚Üê Auto-generated by scanner
```

---

## üÜì Best Free Sources for Pirate Beats

### 1. **Pixabay (Easiest - No Sign Up!)**
- URL: https://pixabay.com/music/
- Search: "pirate", "sea shanty", "nautical", "folk"
- License: Free for commercial use
- Format: Download as MP3, convert to WAV
- Best picks:
  - Search "sea shanty" ‚Üí plenty of options
  - Look for ~90-100 BPM (typical shanty tempo)

### 2. **FreeSoundEffects.com**
- URL: https://www.freesoundeffects.com/free-music/
- Search: "pirate music", "sea music"
- License: Free
- Format: MP3/WAV available

### 3. **YouTube Audio Library**
- URL: https://studio.youtube.com/channel/UC.../music
- Requires: Google account (free)
- Search: "folk", "acoustic", "nautical"
- License: Royalty-free
- Quality: High quality, good variety

### 4. **Free Music Archive**
- URL: https://freemusicarchive.org/
- Search: "folk", "traditional", "sea shanty"
- License: Various Creative Commons licenses
- Format: MP3 (convert to WAV)

### 5. **ccMixter**
- URL: https://ccmixter.org/
- Search: "instrumental folk", "acoustic"
- License: Creative Commons
- Format: MP3/WAV

---

## üõ†Ô∏è How to Prepare Beat Files

### Step 1: Download Beats
Download 3-5 pirate/folk/sea shanty instrumentals from above sources.

### Step 2: Convert to WAV (if needed)
If you downloaded MP3 files, convert them to WAV:

```bash
# Using ffmpeg (already installed)
ffmpeg -i pirate_beat.mp3 -ar 44100 -ac 2 pirate_beat.wav
```

Or use online converter: https://cloudconvert.com/mp3-to-wav

### Step 3: Move to Beats Directory
```bash
# Create directory if needed
mkdir -p beats/pirate-shanty

# Move your WAV files
mv pirate_beat_*.wav beats/pirate-shanty/
```

### Step 4: Run Beat Scanner
```bash
source venv/bin/activate
python scan_beats.py
```

This will:
- Analyze each WAV file
- Detect the BPM automatically
- Create `beats/catalog.json` with metadata

### Step 5: Restart Celery
```bash
# Ctrl+C to stop current Celery worker
source venv/bin/activate
celery -A app.tasks worker --loglevel=info
```

### Step 6: Test!
Generate a new song - it will automatically include background music!

---

## üéØ Recommended Beat Characteristics

For **preschool kids' pirate shanties**, look for:
- **BPM**: 85-105 (slow to moderate tempo)
- **Style**: Folk, acoustic, nautical
- **Instruments**: Accordion, fiddle, acoustic guitar, percussion
- **Mood**: Fun, bouncy, adventurous (not scary!)
- **Length**: At least 30 seconds (will loop automatically)
- **Volume**: Not too loud (vocals should be clear)

---

## üîß Quick Start Example

Here's a complete workflow:

```bash
# 1. Create beats directory
mkdir -p beats/pirate-shanty

# 2. Download a beat from Pixabay (do this in browser)
# Save as: pirate_beat.mp3

# 3. Convert to WAV
ffmpeg -i ~/Downloads/pirate_beat.mp3 -ar 44100 -ac 2 beats/pirate-shanty/pirate_beat.wav

# 4. Scan beats library
python scan_beats.py

# 5. Restart Celery
celery -A app.tasks worker --loglevel=info

# 6. Generate a song!
curl -X POST http://localhost:8000/api/generate -H "Content-Type: application/json" -d '{"word":"ship"}'
```

---

## üìä What Happens During Mixing

Your `app/tasks.py` automatically:

1. **Step 1**: Detects vocal BPM with librosa
   ```python
   vocal_bpm = audio_service.detect_bpm(vocal_path)
   # Example: 92.5 BPM
   ```

2. **Step 2**: Finds closest matching beat
   ```python
   instrumental_path = audio_service.get_instrumental(vocal_path, genre="pirate-shanty")
   # Searches catalog for ~92 BPM pirate beat
   ```

3. **Step 3**: Loops beat to match vocal length
   ```python
   # If vocals are 35 seconds, loops 10-second beat 3.5 times
   ```

4. **Step 4**: Mixes with balanced volumes
   ```python
   # Vocals: 80% volume
   # Instrumental: 50% volume
   # (configured in .env)
   ```

5. **Step 5**: Saves final mixed MP3
   ```
   outputs/song_abc-123.mp3
   ```

---

## ‚öôÔ∏è Volume Settings

Adjust volumes in `.env`:

```bash
# Vocal volume (0.0 to 1.0)
VOCALS_VOLUME=0.8

# Instrumental volume (0.0 to 1.0)
INSTRUMENTAL_VOLUME=0.5
```

Higher = louder. Keep vocals louder so kids can hear the words!

---

## üêõ Troubleshooting

### "No instrumental found, using vocals only"
- **Problem**: No beats in `beats/pirate-shanty/` directory
- **Solution**: Add at least one WAV file and run `scan_beats.py`

### "Closest beat is XX BPM away, exceeds tolerance"
- **Problem**: Your beats are too different in tempo from vocals
- **Solution**:
  - Download beats closer to 90-100 BPM
  - Or increase tolerance in `app/services/beat_manager.py` line 109

### "Error mixing audio"
- **Problem**: Beat file is corrupted or wrong format
- **Solution**: Re-download and ensure it's WAV format (44.1kHz, stereo)

---

## üéâ Done!

Once you add beats and scan them, every new song will automatically include background music! No code changes needed - it's already built into your pipeline.

Happy pirate singing! üè¥‚Äç‚ò†Ô∏èüéµ
